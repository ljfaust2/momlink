<script type="text/javascript" src="../js/load_essentials.js"></script>
<body ng-app="starter" ng-controller="HeaderBarController">
    <script type="text/javascript" src="../js/header.js"></script>
    <script>header('Calendar')</script>
    <script src="../lib/moment/min/moment.min.js"></script>
    <script src="../lib/fullcalendar/dist/fullcalendar.min.js"></script>
    <link rel='stylesheet' href='../lib/fullcalendar/dist/fullcalendar.min.css' />

    <ion-pane>
        <ion-view overflow-scroll="false">
            <ion-content class="has-header padding">
                <script>
                    $(document).ready(function () {
                        $('#calendar').fullCalendar({
                            height: 500,
                            header:{
                                left: 'prev,next, today',
                                center: 'title',
                                right: 'agendaDay, agendaWeek, month'
                            },
 
                            eventAfterRender: function (event, element, view) {
                                element.css('background-color', '#FFB347');
                                element.css('border', '#FFB347');
                                element.css('font-size', '13px');
                                element.css('color', '#000000');
                                element.css('innerHTML', event.start + " " + event.title);
                            },

                            eventDrop: function (event, delta) {
                                var datepicker = moment(event.start).format("MM/DD/YYYY");
                                var start = moment(event.start).format("HH:mm");
                                var end = moment(event.end).format("HH:mm");
                                jQuery.ajax({
                                    url: 'https://momlink.crc.nd.edu/MomLink-PNCC/utilities/event_db.php?f=update_event',
                                    data: 'eventname=' + event.title + '&starttime=' + start + '&endtime=' + end + '&id=' + event.id + '&datepicker=' + datepicker,
                                    type: "POST",
                                    success: function (json) {

                                    }
                                });
                                var source = 'https://momlink.crc.nd.edu/MomLink-PNCC/utilities/event_db.php?f=get_events';
                                jQuery('#calendar').fullCalendar('removeEvents');
                                jQuery('#calendar').fullCalendar('addEventSource', source);
                                jQuery('#calendar').fullCalendar('rerenderEvents');


                            },

                            defaultView: 'agendaDay'
                        })
                    });
                </script>
                <div id='calendar'></div>
            </ion-content>
        </ion-view>
        <ion-footer-bar class="bar-positive" ng-controller="PopupCtrl">
            <!--<div id="uploadHistory" class="buttons" ng-click="uploadTrack()">
                <button class="button button-icon icon ion-ios-cloud-upload-outline"></button>
            </div>-->
            <h1 class="title"></h1>
            <div class="buttons" onclick="window.location='event.html'"><button class="button button-icon icon ion-ios-plus-outline"></button></div>
        </ion-footer-bar>
    </ion-pane>
</body>
<script type="text/javascript" src="../js/load_essentialsEnd.js"></script>
